

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: placeholder.js | Placeholder</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 150px; height: 13px">
        
            <a href="https://github.com/nhnent/tui.jsdoc-template" rel="noopener noreferrer" target="_blank">
                <img src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Placeholder</a></h1>
        
            <span class="version">v2.1.0</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Examples</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Examples</h3><ul><li><a href="tutorial-example01-basic.html">1. Basic</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example01-basic_sub"></div></li><li><a href="tutorial-example02-using-classname.html">2. Using Class Name</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example02-using-classname_sub"></div></li><li><a href="tutorial-example03-dynamic-creation.html">3. Dynamic creation</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example03-dynamic-creation_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-placeholder.html">placeholder</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:placeholder_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-placeholder.html#.generate">generate</a></li><li><a href="module-placeholder.html#.hide">hide</a></li><li><a href="module-placeholder.html#.remove">remove</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Generate the virtual placeholder on browsers isn't supported placeholder feature
 * @author NHN Ent. FE dev team.&lt;dl_javascript@nhnent.com>
 */

'use strict';

var snippet = require('tui-code-snippet');
var util = require('./util.js');

var Placeholder, sharedInstance;
var browser = snippet.browser;
var supportIE = browser.msie &amp;&amp; browser.version &lt;= 11;
var otherBrowser = browser.others;
var supportPlaceholder = 'placeholder' in document.createElement('input') &amp;&amp;
                            'placeholder' in document.createElement('textarea');
var supportPropertychange = browser.msie &amp;&amp; browser.version &lt; 11;
var generatePlaceholder = supportIE || (!supportIE &amp;&amp; !supportPlaceholder) ||
                        (otherBrowser &amp;&amp; !supportPlaceholder);

var KEYCODE_BACK = 8;
var KEYCODE_TAB = 9;
var TARGET_TAGS = [
    'input',
    'textarea'
];
var INPUT_TYPES = [
    'text',
    'password',
    'email',
    'tel',
    'number',
    'url',
    'search'
];
var WRAPPER_STYLE = util.makeStyleText({
    'position': 'relative',
    'display': 'inline-block',
    'overflow': 'hidden'
});
var DEFAULT_STYLE = util.makeStyleText({
    'position': 'absolute',
    'overflow': 'hidden',
    'color': '#999',
    'z-index': '0'
});
var TEMPLATE = '&lt;span style="{{style}}" UNSELECTABLE="on">{{placeholderText}}&lt;/span>';

/**
 * Placeholder Object
 * @constructor
 * @ignore
 */
Placeholder = snippet.defineClass(/** @lends Placeholder.prototype */{
    init: function() {
        /**
         * Array pushed 'input' and 'textarea' elements on page
         * @type {Array}
         * @private
         */
        this.targets = [];
    },

    /**
     * Generate placeholders
     * @param {HTMLElement[]} selectedTargets - Selected elements for generating placeholder
     * @param {object} [options] - options
     *   @param {string} [options.wrapperClassName] - wrapper class name
     * @ignore
     */
    generateOnTargets: function(selectedTargets, options) {
        this.targets = this.targets.concat(selectedTargets);

        snippet.forEach(this.targets, function(target) {
            var placeholder = this._getPlaceholderHtml(target);

            this._attachPlaceholder(target, placeholder, options);
            this._bindEvent(target, target.previousSibling);
        }, this);
    },

    /**
     * Remove placeholders
     * @param {HTMLElement[]} selectedTargets - Selected elements for generating placeholder
     * @ignore
     */
    removeOnTargets: function(selectedTargets) {
        var removeTargets;

        if (selectedTargets) {
            removeTargets = snippet.filter(selectedTargets, function(target) {
                return snippet.inArray(target, this.targets) >= 0;
            }, this);
            this.targets = util.removeArrayItems(this.targets, removeTargets);
        } else {
            removeTargets = this.targets;
            this.targets = [];
        }

        snippet.forEach(removeTargets, function(target) {
            this._unbindEvent(target, target.previousSibling);
            this._detachPlaceholder(target);
        }, this);
    },

    /**
     * Hide placeholders
     * @param {HTMLElements} selectedTargets - Selected elements to hide placeholder
     * @ignore
     */
    hideOnTargets: function(selectedTargets) {
        snippet.forEach(selectedTargets || this.targets, function(target) {
            target.previousSibling.style.display = 'none';
        });
    },

    /**
     * Attach a new virtual placeholder after a selected 'input' element and wrap this element
     * @param {HTMLElement} target - The 'input' or 'textarea' element
     * @param {string} placeholder - HTML string of the virtual placeholder
     * @param {object} [options] - options
     *   @param {string} [options.wrapperClassName] - wrapper class name
     * @private
     */
    _attachPlaceholder: function(target, placeholder, options) {
        var wrapper = document.createElement('span');
        var parentNode = target.parentNode;

        if (options &amp;&amp; options.wrapperClassName) {
            wrapper.className = options.wrapperClassName;
        }
        wrapper.innerHTML = placeholder;
        wrapper.style.cssText = WRAPPER_STYLE;

        parentNode.insertBefore(wrapper, target);

        wrapper.appendChild(target);
    },

    /**
     * Detach generated placeholder and restore the target to original state.
     * @param {HTMLElement} target - The 'input' or 'textarea' element
     * @private
     */
    _detachPlaceholder: function(target) {
        var wrapper = target.parentNode;
        var parentNode = wrapper.parentNode;
        var placeholder = target.previousSibling;

        wrapper.removeChild(placeholder);
        parentNode.insertBefore(target, wrapper);
        parentNode.removeChild(wrapper);
    },

    /**
     * Bind events on the element
     * @param {HTMLElement} target - The 'input' or 'textarea' element
     * @param {HTMLElement} placeholder - The virtual placeholder element
     * @private
     */
    _bindEvent: function(target, placeholder) {
        var placeholderStyle = placeholder.style;

        /**
         * Event handler
         */
        function onKeyup() {
            if (target.value === '') {
                placeholderStyle.display = 'inline-block';
            }
        }

        /**
         * Event handler
         */
        function onChange() {
            if (target.value) {
                placeholderStyle.display = 'none';
            }
        }

        util.bindEvent(placeholder, 'click', function() {
            target.focus();
        });

        if (supportPropertychange) {
            util.bindEvent(target, 'propertychange', onChange);
        } else {
            util.bindEvent(target, 'change', onChange);
        }

        util.bindEvent(target, 'keydown', function(e) {
            var keyCode = e.which || e.keyCode;

            if (!(keyCode === KEYCODE_BACK || keyCode === KEYCODE_TAB ||
                (e.shiftKey &amp;&amp; keyCode === KEYCODE_TAB))) {
                placeholderStyle.display = 'none';
            }
        });

        util.bindEvent(target, 'keyup', onKeyup);
        util.bindEvent(target, 'blur', onKeyup);
    },

    /**
     * Unbind events from the element
     * @param {HTMLElement} target - The 'input' or 'textarea' element
     * @param {HTMLElement} placeholder - The virtual placeholder element
     * @private
     */
    _unbindEvent: function(target, placeholder) {
        util.unbindEvent(target, 'keydown');
        util.unbindEvent(target, 'keyup');
        util.unbindEvent(target, 'blur');
        util.unbindEvent(placeholder, 'click');

        if (supportPropertychange) {
            util.unbindEvent(target, 'propertychange');
        } else {
            util.unbindEvent(target, 'change');
        }
    },

    /**
     * Get the virtual placeholder's html
     * @param {HTMLElement} target - The 'input' or 'textarea' element
     * @returns {string} String of virtual placeholder tag
     * @private
     */
    /* eslint-disable no-useless-escape */
    _getPlaceholderHtml: function(target) {
        var initStyle = util.getStyle(target);
        var placeholderText = target.getAttribute('placeholder');
        var hasValue = target.value !== '';
        var isInput = target.nodeName.toLowerCase() === 'input';
        var styleObj = {
            'display': hasValue ? 'none' : 'inline-block',
            'top': parseInt(initStyle.paddingTop, 10) +
                    parseInt(initStyle.borderTopWidth, 10) + 'px',
            'left': parseInt(initStyle.paddingLeft, 10) +
                    parseInt(initStyle.borderLeftWidth, 10) + 'px',
            'font-size': initStyle.fontSize,
            'font-family': initStyle.fontFamily.replace(/\"/g, '\'')
        };
        var addStyle = !isInput ? {'width': '90%'} : {'white-space': 'nowrap'};

        snippet.extend(styleObj, addStyle);

        return util.applyTemplate(TEMPLATE, {
            style: DEFAULT_STYLE + util.makeStyleText(styleObj),
            placeholderText: placeholderText
        });
    }
    /* eslint-enable no-useless-escape */
});

/**
 * Get all 'input' and 'textarea' elements on page
 * @returns {Array.&lt;HTMLElement>} All elements
 * @ignore
 */
function getAllTargets() {
    var inputs = snippet.toArray(document.getElementsByTagName('input'));
    var textareas = snippet.toArray(document.getElementsByTagName('textarea'));

    return inputs.concat(textareas);
}

if (browser.msie &amp;&amp; (browser.version > 9 &amp;&amp; browser.version &lt;= 11)) {
    util.addCssRule({
        selector: ':-ms-input-placeholder',
        css: 'color:#fff !important;text-indent:-9999px;'
    });
}

sharedInstance = new Placeholder();

/** @module placeholder */
module.exports = {
    /**
     * Generate virtual placeholders.
     * @param {HTMLCollection|HTMLElement[]} selectedTargets - Selected elements for generating placeholder
     * @param {object} [options] - options
     *     @param {string} [options.wrapperClassName] - wrapper class name
     *     @param {boolean} [options.usageStatistics=true] Send the hostname to google analytics.
     *         If you do not want to send the hostname, this option set to false.
     * @function
     * @example
     * var placeholder = tui.placeholder; // require('tui-placeholder');
     *
     * placeholder.generate();
     * placeholder.generate(document.getElementsByTagName('input'));
     * placeholder.generate(document.getElementsByTagName('input'), {
     *     wrapperClassName: 'my-class-name'
     * });
     */
    generate: function(selectedTargets, options) {
        var targets;

        options = snippet.extend({
            usageStatistics: true
        }, options);

        if (generatePlaceholder) {
            targets = selectedTargets ? snippet.toArray(selectedTargets) : getAllTargets();

            sharedInstance.generateOnTargets(snippet.filter(targets, function(target) {
                var tagName = target.nodeName.toLowerCase();
                var inputType = target.type.toLowerCase();
                var disableState = target.disabled || target.readOnly;
                var hasProp = !snippet.isNull(target.getAttribute('placeholder'));
                var enableElem = snippet.inArray(tagName, TARGET_TAGS) > -1;

                if (tagName === 'input') {
                    enableElem = snippet.inArray(inputType, INPUT_TYPES) > -1;
                }

                return hasProp &amp;&amp; enableElem &amp;&amp; !disableState;
            }), options);
        }

        if (options.usageStatistics) {
            util.sendHostNameToGA();
        }
    },

    /**
     * Clear generated placeholders.
     * @param {HTMLCollection|HTMLElement[]} selectedTargets - Selected elements for generating placeholder
     * @function
     */
    remove: function(selectedTargets) {
        var targets;

        if (generatePlaceholder) {
            targets = selectedTargets ? snippet.toArray(selectedTargets) : null;
            sharedInstance.removeOnTargets(targets);
        }
    },

    /**
     * When 'input' or 'textarea' element already has value, hiding the virtual placeholder
     * @param {HTMLCollection|HTMLElement[]} selectedTargets - Selected elements for generating placeholder
     * @function
     */
    hide: function(selectedTargets) {
        var targets;

        if (generatePlaceholder) {
            targets = selectedTargets ? snippet.toArray(selectedTargets) : null;
            sharedInstance.hideOnTargets(targets);
        }
    }
};
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" style="width: 150px; height: 13px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
