/*!
 * tui-component-placeholder.min.js
 * @version 1.2.1
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="dist",t(0)}([function(e,t,n){"use strict";tui.util.defineNamespace("tui.component.placeholder",n(1))},function(e,t,n){"use strict";function i(){var e=tui.util.toArray(document.getElementsByTagName("input")),t=tui.util.toArray(document.getElementsByTagName("textarea"));return e.concat(t)}var r,a,o=n(2),u=tui.util.browser,l="placeholder"in document.createElement("input")&&"placeholder"in document.createElement("textarea"),s=!(u.msie&&u.version<=11),c=u.msie&&u.version<11,d=8,p=9,h=["input","textarea"],v=["text","password","email","tel","number","url","search"],f=o.makeStyleText({position:"relative",display:"inline-block",overflow:"hidden"}),m=o.makeStyleText({position:"absolute",overflow:"hidden",color:"#999","z-index":"0"}),y='<span style="{{style}}" UNSELECTABLE="on">{{placeholderText}}</span>';r=tui.util.defineClass({init:function(){this.targets=[]},generateOnTargets:function(e,t){this.targets=this.targets.concat(e),tui.util.forEach(this.targets,function(e){var n=this._getPlaceholderHtml(e);this._attachPlaceholder(e,n,t),this._bindEvent(e,e.previousSibling)},this)},remove:function(e){var t;e?(t=tui.util.filter(e,function(e){return tui.util.inArray(e,this.targets)>=0},this),this.targets=o.removeArrayItems(this.targets,t)):(t=this.targets,this.targets=[]),tui.util.forEach(t,function(e){this._unbindEvent(e,e.previousSibling),this._detachPlaceholder(e)},this)},hideOnTargets:function(e){tui.util.forEach(e,function(e){e.previousSibling.style.display="none"})},_attachPlaceholder:function(e,t,n){var i=document.createElement("span"),r=e.parentNode;n&&n.wrapperClassName&&(i.className=n.wrapperClassName),i.innerHTML=t,i.style.cssText=f,r.insertBefore(i,e),i.appendChild(e)},_detachPlaceholder:function(e){var t=e.parentNode,n=t.parentNode,i=e.previousSibling;t.removeChild(i),n.insertBefore(e,t),n.removeChild(t)},_bindEvent:function(e,t){function n(){""===e.value&&(r.display="inline-block")}function i(){e.value&&(r.display="none")}var r=t.style;o.bindEvent(t,"click",function(){e.focus()}),c?o.bindEvent(e,"propertychange",i):o.bindEvent(e,"change",i),o.bindEvent(e,"keydown",function(e){var t=e.which||e.keyCode;t===d||t===p||e.shiftKey&&t===p||(r.display="none")}),o.bindEvent(e,"keyup",n),o.bindEvent(e,"blur",n)},_unbindEvent:function(e,t){o.unbindEvent(e,"keydown"),o.unbindEvent(e,"keyup"),o.unbindEvent(e,"blur"),o.unbindEvent(t,"click"),c?o.unbindEvent(e,"propertychange"):o.unbindEvent(e,"change")},_getPlaceholderHtml:function(e){var t=o.getStyle(e),n=e.getAttribute("placeholder"),i=""!==e.value,r="input"===e.nodeName.toLowerCase(),a={display:i?"none":"inline-block",top:parseInt(t.paddingTop,10)+parseInt(t.borderTopWidth,10)+"px",left:parseInt(t.paddingLeft,10)+parseInt(t.borderLeftWidth,10)+"px","font-size":t.fontSize,"font-family":t.fontFamily.replace(/\"/g,"'")},u=r?{"white-space":"nowrap"}:{width:"90%"};return tui.util.extend(a,u),o.applyTemplate(y,{style:m+o.makeStyleText(a),placeholderText:n})}}),u.msie&&u.version>9&&u.version<=11&&o.addCssRule({selector:":-ms-input-placeholder",css:"color:#fff !important;text-indent:-9999px;"}),a=new r,e.exports={generate:function(e,t){var n;l&&s||(n=e?tui.util.toArray(e):i(),a.generateOnTargets(tui.util.filter(n,function(e){var t=e.nodeName.toLowerCase(),n=e.type.toLowerCase(),i=e.disabled||e.readOnly,r=!tui.util.isNull(e.getAttribute("placeholder")),a=tui.util.inArray(t,h)>-1;return"input"===t&&(a=tui.util.inArray(n,v)>-1),r&&a&&!i}),t))},remove:function(e){var t;l&&s||(t=e?tui.util.toArray(e):null,a.remove(t))},hideOnInputHavingValue:function(){l&&s||a.hideOnTargets(tui.util.filter(a.targets,function(e){return""!==e.value&&e.type!==v[1]}))}}},function(e,t){"use strict";var n=function(e){return"__cb_tui_placeholder_"+e+"__"},i=window.getComputedStyle,r={addCssRule:function(e){var t,n=document.createElement("style"),i=e.selector,r=e.css;document.head?document.head.appendChild(n):document.getElementsByTagName("head")[0].appendChild(n),t=n.sheet||n.styleSheet,t.insertRule?t.insertRule(i+"{"+r+"}",0):t.addRule(i,r,0)},bindEvent:function(e,t,i){var r=!0;e.addEventListener&&"propertychange"!==t?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):r=!1,r&&(e[n(t)]=i)},unbindEvent:function(e,t){var i=e[n(t)],r=!0;e.removeEventListener&&"propertychange"!==t?e.removeEventListener(t,i):e.detachEvent?e.detachEvent("on"+t,i):r=!1,r&&delete e[n(t)]},removeArrayItems:function(e,t){return tui.util.filter(e,function(e){return tui.util.inArray(e,t)===-1})},makeStyleText:function(e){var t="";return tui.util.forEach(e,function(e,n){t+=n+":"+e+";"}),t},applyTemplate:function(e,t){var n=e.replace(/\{\{(\w*)\}\}/g,function(e,n){return t.hasOwnProperty(n)?t[n]:""});return n},getStyle:function(e){var t;return t=i?window.getComputedStyle(e,""):e.currentStyle},_callbackPropName:n};e.exports=r}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vdHVpLWNvbXBvbmVudC1wbGFjZWhvbGRlci5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGY3ZTUwY2RlNjIyMjdiZjdkYzc3Iiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcGxhY2Vob2xkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwidHVpIiwidXRpbCIsImRlZmluZU5hbWVzcGFjZSIsImdldEFsbFRhcmdldHMiLCJpbnB1dHMiLCJ0b0FycmF5IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInRleHRhcmVhcyIsImNvbmNhdCIsIlBsYWNlaG9sZGVyIiwic2hhcmVkSW5zdGFuY2UiLCJicm93c2VyIiwiaXNTdXBwb3J0UGxhY2Vob2xkZXIiLCJjcmVhdGVFbGVtZW50IiwiaXNJRSIsIm1zaWUiLCJ2ZXJzaW9uIiwiaXNTdXBwb3J0UHJvcGVydHljaGFuZ2UiLCJLRVlDT0RFX0JBQ0siLCJLRVlDT0RFX1RBQiIsIlRBUkdFVF9UQUdTIiwiSU5QVVRfVFlQRVMiLCJXUkFQUEVSX1NUWUxFIiwibWFrZVN0eWxlVGV4dCIsInBvc2l0aW9uIiwiZGlzcGxheSIsIm92ZXJmbG93IiwiREVGQVVMVF9TVFlMRSIsImNvbG9yIiwiei1pbmRleCIsIlRFTVBMQVRFIiwiZGVmaW5lQ2xhc3MiLCJpbml0IiwidGhpcyIsInRhcmdldHMiLCJnZW5lcmF0ZU9uVGFyZ2V0cyIsInNlbGVjdGVkVGFyZ2V0cyIsIm9wdGlvbnMiLCJmb3JFYWNoIiwidGFyZ2V0IiwicGxhY2Vob2xkZXIiLCJfZ2V0UGxhY2Vob2xkZXJIdG1sIiwiX2F0dGFjaFBsYWNlaG9sZGVyIiwiX2JpbmRFdmVudCIsInByZXZpb3VzU2libGluZyIsInJlbW92ZSIsInJlbW92ZVRhcmdldHMiLCJmaWx0ZXIiLCJpbkFycmF5IiwicmVtb3ZlQXJyYXlJdGVtcyIsIl91bmJpbmRFdmVudCIsIl9kZXRhY2hQbGFjZWhvbGRlciIsImhpZGVPblRhcmdldHMiLCJzdHlsZSIsIndyYXBwZXIiLCJwYXJlbnROb2RlIiwid3JhcHBlckNsYXNzTmFtZSIsImNsYXNzTmFtZSIsImlubmVySFRNTCIsImNzc1RleHQiLCJpbnNlcnRCZWZvcmUiLCJhcHBlbmRDaGlsZCIsInJlbW92ZUNoaWxkIiwib25LZXl1cCIsInZhbHVlIiwicGxhY2Vob2xkZXJTdHlsZSIsIm9uQ2hhbmdlIiwiYmluZEV2ZW50IiwiZm9jdXMiLCJlIiwia2V5Q29kZSIsIndoaWNoIiwic2hpZnRLZXkiLCJ1bmJpbmRFdmVudCIsImluaXRTdHlsZSIsImdldFN0eWxlIiwicGxhY2Vob2xkZXJUZXh0IiwiZ2V0QXR0cmlidXRlIiwiaGFzVmFsdWUiLCJpc0lucHV0Iiwibm9kZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsInN0eWxlT2JqIiwidG9wIiwicGFyc2VJbnQiLCJwYWRkaW5nVG9wIiwiYm9yZGVyVG9wV2lkdGgiLCJsZWZ0IiwicGFkZGluZ0xlZnQiLCJib3JkZXJMZWZ0V2lkdGgiLCJmb250LXNpemUiLCJmb250U2l6ZSIsImZvbnQtZmFtaWx5IiwiZm9udEZhbWlseSIsInJlcGxhY2UiLCJhZGRTdHlsZSIsIndoaXRlLXNwYWNlIiwid2lkdGgiLCJleHRlbmQiLCJhcHBseVRlbXBsYXRlIiwiYWRkQ3NzUnVsZSIsInNlbGVjdG9yIiwiY3NzIiwiZ2VuZXJhdGUiLCJ0YWdOYW1lIiwiaW5wdXRUeXBlIiwidHlwZSIsImRpc2FibGVTdGF0ZSIsImRpc2FibGVkIiwicmVhZE9ubHkiLCJoYXNQcm9wIiwiaXNOdWxsIiwiZW5hYmxlRWxlbSIsImhpZGVPbklucHV0SGF2aW5nVmFsdWUiLCJjYWxsYmFja1Byb3BOYW1lIiwiZXZlbnRUeXBlIiwiaGFzQ29tcHV0ZWRTdHlsZSIsIndpbmRvdyIsInJ1bGVJbmZvIiwic3R5bGVTaGVldCIsInN0eWxlVGFnIiwiaGVhZCIsInNoZWV0IiwiaW5zZXJ0UnVsZSIsImFkZFJ1bGUiLCJjYWxsYmFjayIsInN1Y2Nlc3MiLCJhZGRFdmVudExpc3RlbmVyIiwiYXR0YWNoRXZlbnQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGV0YWNoRXZlbnQiLCJzb3VyY2VJdGVtcyIsInRhcmdldEl0ZW1zIiwiaXRlbSIsInN0eWxlU3RyIiwicHJvcCIsInRlbXBsYXRlIiwicHJvcE9iaiIsIm5ld1RlbXBsYXRlIiwiaGFzT3duUHJvcGVydHkiLCJjb21wdXRlZE9iaiIsImdldENvbXB1dGVkU3R5bGUiLCJjdXJyZW50U3R5bGUiLCJfY2FsbGJhY2tQcm9wTmFtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0NBTVMsU0FBVUEsR0NGbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssUUFBQSxFQVVBLE9BTkFQLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLFFBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0FxQ0EsT0FUQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxPQUdBVixFQUFBLEtEWU0sU0FBU0ksRUFBUUQsRUFBU0gsR0VsRGhDLFlBRUFXLEtBQUFDLEtBQUFDLGdCQUFBLDRCQUFBYixFQUFBLEtGeURNLFNBQVNJLEVBQVFELEVBQVNILEdHdkRoQyxZQTRQQSxTQUFBYyxLQUNBLEdBQUFDLEdBQUFKLElBQUFDLEtBQUFJLFFBQUFDLFNBQUFDLHFCQUFBLFVBQ0FDLEVBQUFSLElBQUFDLEtBQUFJLFFBQUFDLFNBQUFDLHFCQUFBLFlBRUEsT0FBQUgsR0FBQUssT0FB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LFFBQUFTIiwiZmlsZSI6InR1aS1jb21wb25lbnQtcGxhY2Vob2xkZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiB0dWktY29tcG9uZW50LXBsYWNlaG9sZGVyLm1pbi5qc1xuICogQHZlcnNpb24gMS4yLjFcbiAqIEBhdXRob3IgTkhORW50IEZFIERldmVsb3BtZW50IExhYiA8ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPlxuICogQGxpY2Vuc2UgTUlUXG4gKi9cbi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcImRpc3RcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0LyoqIEBuYW1lc3BhY2UgdHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlciAqL1xuXHR0dWkudXRpbC5kZWZpbmVOYW1lc3BhY2UoJ3R1aS5jb21wb25lbnQucGxhY2Vob2xkZXInLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpKTtcblxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0LyoqXG5cdCAqIEBmaWxlb3ZlcnZpZXcgR2VuZXJhdGUgdGhlIHZpcnR1YWwgcGxhY2Vob2xkZXIgb24gYnJvd3NlcnMgaXNuJ3Qgc3VwcG9ydGVkIHBsYWNlaG9sZGVyIGZlYXR1cmVcblx0ICogQGF1dGhvciBOSE4gRW50LiBGRSBkZXYgdGVhbS48ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPlxuXHQgKi9cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIFBsYWNlaG9sZGVyLCBzaGFyZWRJbnN0YW5jZTtcblx0dmFyIGJyb3dzZXIgPSB0dWkudXRpbC5icm93c2VyO1xuXHR2YXIgaXNTdXBwb3J0UGxhY2Vob2xkZXIgPSAncGxhY2Vob2xkZXInIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgJiZcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwbGFjZWhvbGRlcicgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcblx0dmFyIGlzSUUgPSAhKGJyb3dzZXIubXNpZSAmJiBicm93c2VyLnZlcnNpb24gPD0gMTEpO1xuXHR2YXIgaXNTdXBwb3J0UHJvcGVydHljaGFuZ2UgPSAoYnJvd3Nlci5tc2llICYmIGJyb3dzZXIudmVyc2lvbiA8IDExKTtcblx0XG5cdHZhciBLRVlDT0RFX0JBQ0sgPSA4O1xuXHR2YXIgS0VZQ09ERV9UQUIgPSA5O1xuXHR2YXIgVEFSR0VUX1RBR1MgPSBbXG5cdCAgICAnaW5wdXQnLFxuXHQgICAgJ3RleHRhcmVhJ1xuXHRdO1xuXHR2YXIgSU5QVVRfVFlQRVMgPSBbXG5cdCAgICAndGV4dCcsXG5cdCAgICAncGFzc3dvcmQnLFxuXHQgICAgJ2VtYWlsJyxcblx0ICAgICd0ZWwnLFxuXHQgICAgJ251bWJlcicsXG5cdCAgICAndXJsJyxcblx0ICAgICdzZWFyY2gnXG5cdF07XG5cdHZhciBXUkFQUEVSX1NUWUxFID0gdXRpbC5tYWtlU3R5bGVUZXh0KHtcblx0ICAgICdwb3NpdGlvbic6ICdyZWxhdGl2ZScsXG5cdCAgICAnZGlzcGxheSc6ICdpbmxpbmUtYmxvY2snLFxuXHQgICAgJ292ZXJmbG93JzogJ2hpZGRlbidcblx0fSk7XG5cdHZhciBERUZBVUxUX1NUWUxFID0gdXRpbC5tYWtlU3R5bGVUZXh0KHtcblx0ICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsXG5cdCAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcblx0ICAgICdjb2xvcic6ICcjOTk5Jyxcblx0ICAgICd6LWluZGV4JzogJzAnXG5cdH0pO1xuXHR2YXIgVEVNUExBVEUgPSAnPHNwYW4gc3R5bGU9XCJ7e3N0eWxlfX1cIiBVTlNFTEVDVEFCTEU9XCJvblwiPnt7cGxhY2Vob2xkZXJUZXh0fX08L3NwYW4+Jztcblx0XG5cdC8qKlxuXHQgKiBQbGFjZWhvbGRlciBPYmplY3Rcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqIEBpZ25vcmVcblx0ICovXG5cdFBsYWNlaG9sZGVyID0gdHVpLnV0aWwuZGVmaW5lQ2xhc3MoLyoqIEBsZW5kcyBQbGFjZWhvbGRlci5wcm90b3R5cGUgKi97XG5cdCAgICBpbml0OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBcnJheSBwdXNoZWQgJ2lucHV0JyBhbmQgJ3RleHRhcmVhJyBlbGVtZW50cyBvbiBwYWdlXG5cdCAgICAgICAgICogQHR5cGUge0FycmF5fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy50YXJnZXRzID0gW107XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2VuZXJhdGUgcGxhY2Vob2xkZXJzXG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG5cdCAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gb3B0aW9uc1xuXHQgICAgICogICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMud3JhcHBlckNsYXNzTmFtZV0gLSB3cmFwcGVyIGNsYXNzIG5hbWVcblx0ICAgICAqIEBpZ25vcmVcblx0ICAgICAqL1xuXHQgICAgZ2VuZXJhdGVPblRhcmdldHM6IGZ1bmN0aW9uKHNlbGVjdGVkVGFyZ2V0cywgb3B0aW9ucykge1xuXHQgICAgICAgIHRoaXMudGFyZ2V0cyA9IHRoaXMudGFyZ2V0cy5jb25jYXQoc2VsZWN0ZWRUYXJnZXRzKTtcblx0XG5cdCAgICAgICAgdHVpLnV0aWwuZm9yRWFjaCh0aGlzLnRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSB0aGlzLl9nZXRQbGFjZWhvbGRlckh0bWwodGFyZ2V0KTtcblx0XG5cdCAgICAgICAgICAgIHRoaXMuX2F0dGFjaFBsYWNlaG9sZGVyKHRhcmdldCwgcGxhY2Vob2xkZXIsIG9wdGlvbnMpO1xuXHQgICAgICAgICAgICB0aGlzLl9iaW5kRXZlbnQodGFyZ2V0LCB0YXJnZXQucHJldmlvdXNTaWJsaW5nKTtcblx0ICAgICAgICB9LCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZW1vdmUgcGxhY2Vob2xkZXJzXG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG5cdCAgICAgKiBAaWdub3JlXG5cdCAgICAgKi9cblx0ICAgIHJlbW92ZTogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzKSB7XG5cdCAgICAgICAgdmFyIHJlbW92ZVRhcmdldHM7XG5cdFxuXHQgICAgICAgIGlmIChzZWxlY3RlZFRhcmdldHMpIHtcblx0ICAgICAgICAgICAgcmVtb3ZlVGFyZ2V0cyA9IHR1aS51dGlsLmZpbHRlcihzZWxlY3RlZFRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHR1aS51dGlsLmluQXJyYXkodGFyZ2V0LCB0aGlzLnRhcmdldHMpID49IDA7XG5cdCAgICAgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgICAgICAgICB0aGlzLnRhcmdldHMgPSB1dGlsLnJlbW92ZUFycmF5SXRlbXModGhpcy50YXJnZXRzLCByZW1vdmVUYXJnZXRzKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICByZW1vdmVUYXJnZXRzID0gdGhpcy50YXJnZXRzO1xuXHQgICAgICAgICAgICB0aGlzLnRhcmdldHMgPSBbXTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHR1aS51dGlsLmZvckVhY2gocmVtb3ZlVGFyZ2V0cywgZnVuY3Rpb24odGFyZ2V0KSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3VuYmluZEV2ZW50KHRhcmdldCwgdGFyZ2V0LnByZXZpb3VzU2libGluZyk7XG5cdCAgICAgICAgICAgIHRoaXMuX2RldGFjaFBsYWNlaG9sZGVyKHRhcmdldCk7XG5cdCAgICAgICAgfSwgdGhpcyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogSGlkZSBwbGFjZWhvbGRlcnMgb24gJ2lucHV0JyBvciAndGV4dGFyZWEnIGVsZW1lbnQgdGhhdCBhbHJlYWR5IGhhcyB2YWx1ZVxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHN9IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIHRvIGhpZGUgcGxhY2Vob2xkZXJcblx0ICAgICAqIEBpZ25vcmVcblx0ICAgICAqL1xuXHQgICAgaGlkZU9uVGFyZ2V0czogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzKSB7XG5cdCAgICAgICAgdHVpLnV0aWwuZm9yRWFjaChzZWxlY3RlZFRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgICAgICB0YXJnZXQucHJldmlvdXNTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQXR0YWNoIGEgbmV3IHZpcnR1YWwgcGxhY2Vob2xkZXIgYWZ0ZXIgYSBzZWxlY3RlZCAnaW5wdXQnIGVsZW1lbnQgYW5kIHdyYXAgdGhpcyBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBUaGUgJ2lucHV0JyBvciAndGV4dGFyZWEnIGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwbGFjZWhvbGRlciAtIEhUTUwgc3RyaW5nIG9mIHRoZSB2aXJ0dWFsIHBsYWNlaG9sZGVyXG5cdCAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gb3B0aW9uc1xuXHQgICAgICogICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMud3JhcHBlckNsYXNzTmFtZV0gLSB3cmFwcGVyIGNsYXNzIG5hbWVcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9hdHRhY2hQbGFjZWhvbGRlcjogZnVuY3Rpb24odGFyZ2V0LCBwbGFjZWhvbGRlciwgb3B0aW9ucykge1xuXHQgICAgICAgIHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXHQgICAgICAgIHZhciBwYXJlbnROb2RlID0gdGFyZ2V0LnBhcmVudE5vZGU7XG5cdFxuXHQgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMud3JhcHBlckNsYXNzTmFtZSkge1xuXHQgICAgICAgICAgICB3cmFwcGVyLmNsYXNzTmFtZSA9IG9wdGlvbnMud3JhcHBlckNsYXNzTmFtZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgd3JhcHBlci5pbm5lckhUTUwgPSBwbGFjZWhvbGRlcjtcblx0ICAgICAgICB3cmFwcGVyLnN0eWxlLmNzc1RleHQgPSBXUkFQUEVSX1NUWUxFO1xuXHRcblx0ICAgICAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLCB0YXJnZXQpO1xuXHRcblx0ICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHRhcmdldCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRGV0YWNoIGdlbmVyYXRlZCBwbGFjZWhvbGRlciBhbmQgcmVzdG9yZSB0aGUgdGFyZ2V0IHRvIG9yaWdpbmFsIHN0YXRlLlxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gVGhlICdpbnB1dCcgb3IgJ3RleHRhcmVhJyBlbGVtZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZGV0YWNoUGxhY2Vob2xkZXI6IGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgIHZhciB3cmFwcGVyID0gdGFyZ2V0LnBhcmVudE5vZGU7XG5cdCAgICAgICAgdmFyIHBhcmVudE5vZGUgPSB3cmFwcGVyLnBhcmVudE5vZGU7XG5cdCAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gdGFyZ2V0LnByZXZpb3VzU2libGluZztcblx0XG5cdCAgICAgICAgd3JhcHBlci5yZW1vdmVDaGlsZChwbGFjZWhvbGRlcik7XG5cdCAgICAgICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGFyZ2V0LCB3cmFwcGVyKTtcblx0ICAgICAgICBwYXJlbnROb2RlLnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEJpbmQgZXZlbnRzIG9uIHRoZSBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBUaGUgJ2lucHV0JyBvciAndGV4dGFyZWEnIGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHBsYWNlaG9sZGVyIC0gVGhlIHZpcnR1YWwgcGxhY2Vob2xkZXIgZWxlbWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2JpbmRFdmVudDogZnVuY3Rpb24odGFyZ2V0LCBwbGFjZWhvbGRlcikge1xuXHQgICAgICAgIHZhciBwbGFjZWhvbGRlclN0eWxlID0gcGxhY2Vob2xkZXIuc3R5bGU7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEV2ZW50IGhhbmRsZXJcblx0ICAgICAgICAgKi9cblx0ICAgICAgICBmdW5jdGlvbiBvbktleXVwKCkge1xuXHQgICAgICAgICAgICBpZiAodGFyZ2V0LnZhbHVlID09PSAnJykge1xuXHQgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJTdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEV2ZW50IGhhbmRsZXJcblx0ICAgICAgICAgKi9cblx0ICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZSgpIHtcblx0ICAgICAgICAgICAgaWYgKHRhcmdldC52YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJTdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB1dGlsLmJpbmRFdmVudChwbGFjZWhvbGRlciwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHRhcmdldC5mb2N1cygpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpZiAoaXNTdXBwb3J0UHJvcGVydHljaGFuZ2UpIHtcblx0ICAgICAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAncHJvcGVydHljaGFuZ2UnLCBvbkNoYW5nZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAnY2hhbmdlJywgb25DaGFuZ2UpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBlLndoaWNoIHx8IGUua2V5Q29kZTtcblx0XG5cdCAgICAgICAgICAgIGlmICghKGtleUNvZGUgPT09IEtFWUNPREVfQkFDSyB8fCBrZXlDb2RlID09PSBLRVlDT0RFX1RBQiB8fFxuXHQgICAgICAgICAgICAgICAgKGUuc2hpZnRLZXkgJiYga2V5Q29kZSA9PT0gS0VZQ09ERV9UQUIpKSkge1xuXHQgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJTdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHV0aWwuYmluZEV2ZW50KHRhcmdldCwgJ2tleXVwJywgb25LZXl1cCk7XG5cdCAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAnYmx1cicsIG9uS2V5dXApO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFVuYmluZCBldmVudHMgZnJvbSB0aGUgZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gVGhlICdpbnB1dCcgb3IgJ3RleHRhcmVhJyBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBwbGFjZWhvbGRlciAtIFRoZSB2aXJ0dWFsIHBsYWNlaG9sZGVyIGVsZW1lbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF91bmJpbmRFdmVudDogZnVuY3Rpb24odGFyZ2V0LCBwbGFjZWhvbGRlcikge1xuXHQgICAgICAgIHV0aWwudW5iaW5kRXZlbnQodGFyZ2V0LCAna2V5ZG93bicpO1xuXHQgICAgICAgIHV0aWwudW5iaW5kRXZlbnQodGFyZ2V0LCAna2V5dXAnKTtcblx0ICAgICAgICB1dGlsLnVuYmluZEV2ZW50KHRhcmdldCwgJ2JsdXInKTtcblx0ICAgICAgICB1dGlsLnVuYmluZEV2ZW50KHBsYWNlaG9sZGVyLCAnY2xpY2snKTtcblx0XG5cdCAgICAgICAgaWYgKGlzU3VwcG9ydFByb3BlcnR5Y2hhbmdlKSB7XG5cdCAgICAgICAgICAgIHV0aWwudW5iaW5kRXZlbnQodGFyZ2V0LCAncHJvcGVydHljaGFuZ2UnKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB1dGlsLnVuYmluZEV2ZW50KHRhcmdldCwgJ2NoYW5nZScpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgdGhlIHZpcnR1YWwgcGxhY2Vob2xkZXIncyBodG1sXG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBUaGUgJ2lucHV0JyBvciAndGV4dGFyZWEnIGVsZW1lbnRcblx0ICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFN0cmluZyBvZiB2aXJ0dWFsIHBsYWNlaG9sZGVyIHRhZ1xuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgLyogZXNsaW50LWRpc2FibGUgbm8tdXNlbGVzcy1lc2NhcGUgKi9cblx0ICAgIF9nZXRQbGFjZWhvbGRlckh0bWw6IGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgIHZhciBpbml0U3R5bGUgPSB1dGlsLmdldFN0eWxlKHRhcmdldCk7XG5cdCAgICAgICAgdmFyIHBsYWNlaG9sZGVyVGV4dCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyk7XG5cdCAgICAgICAgdmFyIGhhc1ZhbHVlID0gdGFyZ2V0LnZhbHVlICE9PSAnJztcblx0ICAgICAgICB2YXIgaXNJbnB1dCA9IHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW5wdXQnO1xuXHQgICAgICAgIHZhciBzdHlsZU9iaiA9IHtcblx0ICAgICAgICAgICAgJ2Rpc3BsYXknOiBoYXNWYWx1ZSA/ICdub25lJyA6ICdpbmxpbmUtYmxvY2snLFxuXHQgICAgICAgICAgICAndG9wJzogcGFyc2VJbnQoaW5pdFN0eWxlLnBhZGRpbmdUb3AsIDEwKSArXG5cdCAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoaW5pdFN0eWxlLmJvcmRlclRvcFdpZHRoLCAxMCkgKyAncHgnLFxuXHQgICAgICAgICAgICAnbGVmdCc6IHBhcnNlSW50KGluaXRTdHlsZS5wYWRkaW5nTGVmdCwgMTApICtcblx0ICAgICAgICAgICAgICAgICAgICBwYXJzZUludChpbml0U3R5bGUuYm9yZGVyTGVmdFdpZHRoLCAxMCkgKyAncHgnLFxuXHQgICAgICAgICAgICAnZm9udC1zaXplJzogaW5pdFN0eWxlLmZvbnRTaXplLFxuXHQgICAgICAgICAgICAnZm9udC1mYW1pbHknOiBpbml0U3R5bGUuZm9udEZhbWlseS5yZXBsYWNlKC9cXFwiL2csICdcXCcnKVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgdmFyIGFkZFN0eWxlID0gIWlzSW5wdXQgPyB7J3dpZHRoJzogJzkwJSd9IDogeyd3aGl0ZS1zcGFjZSc6ICdub3dyYXAnfTtcblx0XG5cdCAgICAgICAgdHVpLnV0aWwuZXh0ZW5kKHN0eWxlT2JqLCBhZGRTdHlsZSk7XG5cdFxuXHQgICAgICAgIHJldHVybiB1dGlsLmFwcGx5VGVtcGxhdGUoVEVNUExBVEUsIHtcblx0ICAgICAgICAgICAgc3R5bGU6IERFRkFVTFRfU1RZTEUgKyB1dGlsLm1ha2VTdHlsZVRleHQoc3R5bGVPYmopLFxuXHQgICAgICAgICAgICBwbGFjZWhvbGRlclRleHQ6IHBsYWNlaG9sZGVyVGV4dFxuXHQgICAgICAgIH0pO1xuXHQgICAgfVxuXHQgICAgLyogZXNsaW50LWVuYWJsZSBuby11c2VsZXNzLWVzY2FwZSAqL1xuXHR9KTtcblx0XG5cdC8qKlxuXHQgKiBHZXQgYWxsICdpbnB1dCcgYW5kICd0ZXh0YXJlYScgZWxlbWVudHMgb24gcGFnZVxuXHQgKiBAcmV0dXJucyB7QXJyYXkuPEhUTUxFbGVtZW50Pn0gQWxsIGVsZW1lbnRzXG5cdCAqIEBpZ25vcmVcblx0ICovXG5cdGZ1bmN0aW9uIGdldEFsbFRhcmdldHMoKSB7XG5cdCAgICB2YXIgaW5wdXRzID0gdHVpLnV0aWwudG9BcnJheShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSk7XG5cdCAgICB2YXIgdGV4dGFyZWFzID0gdHVpLnV0aWwudG9BcnJheShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGV4dGFyZWEnKSk7XG5cdFxuXHQgICAgcmV0dXJuIGlucHV0cy5jb25jYXQodGV4dGFyZWFzKTtcblx0fVxuXHRcblx0aWYgKGJyb3dzZXIubXNpZSAmJiAoYnJvd3Nlci52ZXJzaW9uID4gOSAmJiBicm93c2VyLnZlcnNpb24gPD0gMTEpKSB7XG5cdCAgICB1dGlsLmFkZENzc1J1bGUoe1xuXHQgICAgICAgIHNlbGVjdG9yOiAnOi1tcy1pbnB1dC1wbGFjZWhvbGRlcicsXG5cdCAgICAgICAgY3NzOiAnY29sb3I6I2ZmZiAhaW1wb3J0YW50O3RleHQtaW5kZW50Oi05OTk5cHg7J1xuXHQgICAgfSk7XG5cdH1cblx0XG5cdHNoYXJlZEluc3RhbmNlID0gbmV3IFBsYWNlaG9sZGVyKCk7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IHtcblx0ICAgIC8qKlxuXHQgICAgICogR2VuZXJhdGUgdmlydHVhbCBwbGFjZWhvbGRlcnMuXG5cdCAgICAgKiBAcGFyYW0ge0hUTUxDb2xsZWN0aW9ufEhUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG5cdCAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gb3B0aW9uc1xuXHQgICAgICogICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMud3JhcHBlckNsYXNzTmFtZV0gLSB3cmFwcGVyIGNsYXNzIG5hbWVcblx0ICAgICAqIEBtZW1iZXJvZiB0dWkuY29tcG9uZW50LnBsYWNlaG9sZGVyXG5cdCAgICAgKiBAZnVuY3Rpb25cblx0ICAgICAqIEBhcGlcblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiB0dWkuY29tcG9uZW50LnBsYWNlaG9sZGVyLmdlbmVyYXRlKCk7XG5cdCAgICAgKiB0dWkuY29tcG9uZW50LnBsYWNlaG9sZGVyLmdlbmVyYXRlKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpKTtcblx0ICAgICAqIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXIuZ2VuZXJhdGUoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JyksIHtcblx0ICAgICAqICAgICB3cmFwcGVyQ2xhc3NOYW1lOiAnbXktY2xhc3MtbmFtZSdcblx0ICAgICAqIH0pO1xuXHQgICAgICovXG5cdCAgICBnZW5lcmF0ZTogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzLCBvcHRpb25zKSB7XG5cdCAgICAgICAgdmFyIHRhcmdldHM7XG5cdFxuXHQgICAgICAgIGlmIChpc1N1cHBvcnRQbGFjZWhvbGRlciAmJiBpc0lFKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRhcmdldHMgPSAoc2VsZWN0ZWRUYXJnZXRzKSA/IHR1aS51dGlsLnRvQXJyYXkoc2VsZWN0ZWRUYXJnZXRzKSA6IGdldEFsbFRhcmdldHMoKTtcblx0XG5cdCAgICAgICAgc2hhcmVkSW5zdGFuY2UuZ2VuZXJhdGVPblRhcmdldHModHVpLnV0aWwuZmlsdGVyKHRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgICAgICB2YXIgdGFnTmFtZSA9IHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHQgICAgICAgICAgICB2YXIgaW5wdXRUeXBlID0gdGFyZ2V0LnR5cGUudG9Mb3dlckNhc2UoKTtcblx0ICAgICAgICAgICAgdmFyIGRpc2FibGVTdGF0ZSA9IHRhcmdldC5kaXNhYmxlZCB8fCB0YXJnZXQucmVhZE9ubHk7XG5cdCAgICAgICAgICAgIHZhciBoYXNQcm9wID0gIXR1aS51dGlsLmlzTnVsbCh0YXJnZXQuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpKTtcblx0ICAgICAgICAgICAgdmFyIGVuYWJsZUVsZW0gPSB0dWkudXRpbC5pbkFycmF5KHRhZ05hbWUsIFRBUkdFVF9UQUdTKSA+IC0xO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRhZ05hbWUgPT09ICdpbnB1dCcpIHtcblx0ICAgICAgICAgICAgICAgIGVuYWJsZUVsZW0gPSB0dWkudXRpbC5pbkFycmF5KGlucHV0VHlwZSwgSU5QVVRfVFlQRVMpID4gLTE7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBoYXNQcm9wICYmIGVuYWJsZUVsZW0gJiYgIWRpc2FibGVTdGF0ZTtcblx0ICAgICAgICB9KSwgb3B0aW9ucyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2xlYXIgZ2VuZXJhdGVkIHBsYWNlaG9sZGVycy5cblx0ICAgICAqIEBtZW1iZXJvZiB0dWkuY29tcG9uZW50LnBsYWNlaG9sZGVyXG5cdCAgICAgKiBAZnVuY3Rpb25cblx0ICAgICAqIEBwYXJhbSB7SFRNTENvbGxlY3Rpb258SFRNTEVsZW1lbnRbXX0gc2VsZWN0ZWRUYXJnZXRzIC0gU2VsZWN0ZWQgZWxlbWVudHMgZm9yIGdlbmVyYXRpbmcgcGxhY2Vob2xkZXJcblx0ICAgICAqL1xuXHQgICAgcmVtb3ZlOiBmdW5jdGlvbihzZWxlY3RlZFRhcmdldHMpIHtcblx0ICAgICAgICB2YXIgdGFyZ2V0cztcblx0XG5cdCAgICAgICAgaWYgKGlzU3VwcG9ydFBsYWNlaG9sZGVyICYmIGlzSUUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGFyZ2V0cyA9IChzZWxlY3RlZFRhcmdldHMpID8gdHVpLnV0aWwudG9BcnJheShzZWxlY3RlZFRhcmdldHMpIDogbnVsbDtcblx0ICAgICAgICBzaGFyZWRJbnN0YW5jZS5yZW1vdmUodGFyZ2V0cyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogV2hlbiAnaW5wdXQnIG9yICd0ZXh0YXJlYScgZWxlbWVudCBhbHJlYWR5IGhhcyB2YWx1ZSwgaGlkaW5nIHRoZSB2aXJ0dWFsIHBsYWNlaG9sZGVyXG5cdCAgICAgKiBAbWVtYmVyb2YgdHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlclxuXHQgICAgICogQGZ1bmN0aW9uXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogdHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlci5oaWRlT25JbnB1dEhhdmluZ1ZhbHVlKCk7XG5cdCAgICAgKi9cblx0ICAgIGhpZGVPbklucHV0SGF2aW5nVmFsdWU6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChpc1N1cHBvcnRQbGFjZWhvbGRlciAmJiBpc0lFKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHNoYXJlZEluc3RhbmNlLmhpZGVPblRhcmdldHModHVpLnV0aWwuZmlsdGVyKHNoYXJlZEluc3RhbmNlLnRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuXHQgICAgICAgICAgICByZXR1cm4gKHRhcmdldC52YWx1ZSAhPT0gJycgJiYgdGFyZ2V0LnR5cGUgIT09IElOUFVUX1RZUEVTWzFdKTtcblx0ICAgICAgICB9KSk7XG5cdCAgICB9XG5cdH07XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBjYWxsYmFja1Byb3BOYW1lID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG5cdCAgICByZXR1cm4gJ19fY2JfdHVpX3BsYWNlaG9sZGVyXycgKyBldmVudFR5cGUgKyAnX18nO1xuXHR9O1xuXHRcblx0dmFyIGhhc0NvbXB1dGVkU3R5bGUgPSAod2luZG93LmdldENvbXB1dGVkU3R5bGUpO1xuXHRcblx0dmFyIHV0aWwgPSB7XG5cdCAgICAvKipcblx0ICAgICAqIEdlbmVyYXRlICdzdHlsZScgZWxlbWVudCBhbmQgYWRkIGNzcyBydWxlXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gcnVsZUluZm8gLSBWYWx1ZSBvZiBzZWxlY3RvciBhbmQgY3NzIHByb3BlcnR5XG5cdCAgICAgKi9cblx0ICAgIGFkZENzc1J1bGU6IGZ1bmN0aW9uKHJ1bGVJbmZvKSB7XG5cdCAgICAgICAgdmFyIHN0eWxlVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcblx0ICAgICAgICB2YXIgc2VsZWN0b3IgPSBydWxlSW5mby5zZWxlY3Rvcjtcblx0ICAgICAgICB2YXIgY3NzID0gcnVsZUluZm8uY3NzO1xuXHQgICAgICAgIHZhciBzdHlsZVNoZWV0O1xuXHRcblx0ICAgICAgICBpZiAoZG9jdW1lbnQuaGVhZCkge1xuXHQgICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlVGFnKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKHN0eWxlVGFnKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHN0eWxlU2hlZXQgPSBzdHlsZVRhZy5zaGVldCB8fCBzdHlsZVRhZy5zdHlsZVNoZWV0O1xuXHRcblx0ICAgICAgICBpZiAoc3R5bGVTaGVldC5pbnNlcnRSdWxlKSB7XG5cdCAgICAgICAgICAgIHN0eWxlU2hlZXQuaW5zZXJ0UnVsZShzZWxlY3RvciArICd7JyArIGNzcyArICd9JywgMCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgc3R5bGVTaGVldC5hZGRSdWxlKHNlbGVjdG9yLCBjc3MsIDApO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBCaW5kIGV2ZW50IHRvIGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCAtIERPTSBlbGVtZW50IHRvIGF0dGFjaCB0aGUgZXZlbnQgaGFuZGxlciBvblxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZSAtIEV2ZW50IHR5cGVcblx0ICAgICAqIEBwYXJhbSB7cmVxdWVzdENhbGxiYWNrfSBjYWxsYmFjayAtIEV2ZW50IGhhbmRsZXIgZnVuY3Rpb25cblx0ICAgICAqL1xuXHQgICAgYmluZEV2ZW50OiBmdW5jdGlvbih0YXJnZXQsIGV2ZW50VHlwZSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgc3VjY2VzcyA9IHRydWU7XG5cdFxuXHQgICAgICAgIGlmICh0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lciAmJiBldmVudFR5cGUgIT09ICdwcm9wZXJ0eWNoYW5nZScpIHtcblx0ICAgICAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYWxsYmFjaywgZmFsc2UpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0LmF0dGFjaEV2ZW50KSB7XG5cdCAgICAgICAgICAgIHRhcmdldC5hdHRhY2hFdmVudCgnb24nICsgZXZlbnRUeXBlLCBjYWxsYmFjayk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcblx0ICAgICAgICAgICAgdGFyZ2V0W2NhbGxiYWNrUHJvcE5hbWUoZXZlbnRUeXBlKV0gPSBjYWxsYmFjaztcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVW5iaW5kIGV2ZW50IGZyb20gZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gRE9NIGVsZW1lbnQgdG8gZGV0YWNoIHRoZSBldmVudCBoYW5kbGVyIGZyb21cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGUgLSBFdmVudCB0eXBlXG5cdCAgICAgKi9cblx0ICAgIHVuYmluZEV2ZW50OiBmdW5jdGlvbih0YXJnZXQsIGV2ZW50VHlwZSkge1xuXHQgICAgICAgIHZhciBjYWxsYmFjayA9IHRhcmdldFtjYWxsYmFja1Byb3BOYW1lKGV2ZW50VHlwZSldO1xuXHQgICAgICAgIHZhciBzdWNjZXNzID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgaWYgKHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyICYmIGV2ZW50VHlwZSAhPT0gJ3Byb3BlcnR5Y2hhbmdlJykge1xuXHQgICAgICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGNhbGxiYWNrKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRhcmdldC5kZXRhY2hFdmVudCkge1xuXHQgICAgICAgICAgICB0YXJnZXQuZGV0YWNoRXZlbnQoJ29uJyArIGV2ZW50VHlwZSwgY2FsbGJhY2spO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChzdWNjZXNzKSB7XG5cdCAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRbY2FsbGJhY2tQcm9wTmFtZShldmVudFR5cGUpXTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmVtb3ZlIHRhcmdldCBpdGVtcyBmcm9tIHNvdXJjZSBhcnJheSBhbmQgcmV0dXJucyBhIG5ldyByZW1vdmVkIGFycmF5LlxuXHQgICAgICogQHBhcmFtIHthcnJheX0gc291cmNlSXRlbXMgLSBzb3VyY2UgYXJyYXlcblx0ICAgICAqIEBwYXJhbSB7YXJyYXl9IHRhcmdldEl0ZW1zIC0gdGFyZ2V0IGl0ZW1zXG5cdCAgICAgKiBAcmV0dXJucyB7YXJyYXl9IG5ldyByZW1vdmVkIGFycmF5XG5cdCAgICAgKi9cblx0ICAgIHJlbW92ZUFycmF5SXRlbXM6IGZ1bmN0aW9uKHNvdXJjZUl0ZW1zLCB0YXJnZXRJdGVtcykge1xuXHQgICAgICAgIHJldHVybiB0dWkudXRpbC5maWx0ZXIoc291cmNlSXRlbXMsIGZ1bmN0aW9uKGl0ZW0pIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHR1aS51dGlsLmluQXJyYXkoaXRlbSwgdGFyZ2V0SXRlbXMpID09PSAtMTtcblx0ICAgICAgICB9KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBNYWtlIENTU1RleHRcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdHlsZU9iaiAtIFN0eWxlIGluZm8gb2JqZWN0XG5cdCAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBDb25uZWN0ZWQgc3RyaW5nIG9mIHN0eWxlXG5cdCAgICAgKi9cblx0ICAgIG1ha2VTdHlsZVRleHQ6IGZ1bmN0aW9uKHN0eWxlT2JqKSB7XG5cdCAgICAgICAgdmFyIHN0eWxlU3RyID0gJyc7XG5cdFxuXHQgICAgICAgIHR1aS51dGlsLmZvckVhY2goc3R5bGVPYmosIGZ1bmN0aW9uKHZhbHVlLCBwcm9wKSB7XG5cdCAgICAgICAgICAgIHN0eWxlU3RyICs9IHByb3AgKyAnOicgKyB2YWx1ZSArICc7Jztcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgcmV0dXJuIHN0eWxlU3RyO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJlcGxhY2UgbWF0Y2hlZCBwcm9wZXJ0eSB3aXRoIHRlbXBsYXRlXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGVtcGxhdGUgLSBTdHJpbmcgb2YgdGVtcGxhdGVcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wT2JqIC0gUHJvcGVydGllc1xuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gUmVwbGFjZWQgdGVtcGxhdGUgc3RyaW5nXG5cdCAgICAgKi9cblx0ICAgIGFwcGx5VGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlLCBwcm9wT2JqKSB7XG5cdCAgICAgICAgdmFyIG5ld1RlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7KFxcdyopXFx9XFx9L2csIGZ1bmN0aW9uKHZhbHVlLCBwcm9wKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBwcm9wT2JqLmhhc093blByb3BlcnR5KHByb3ApID8gcHJvcE9ialtwcm9wXSA6ICcnO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gbmV3VGVtcGxhdGU7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJucyBlbGVtZW50J3Mgc3R5bGUgdmFsdWUgZGVmaW5lZCBhdCBjc3MgZmlsZVxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gQ3VycmVudCBlbGVtZW50XG5cdCAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBTdHlsZSBvYmplY3Qgb2YgZWxlbWVudFxuXHQgICAgICovXG5cdCAgICBnZXRTdHlsZTogZnVuY3Rpb24odGFyZ2V0KSB7XG5cdCAgICAgICAgdmFyIGNvbXB1dGVkT2JqO1xuXHRcblx0ICAgICAgICBpZiAoaGFzQ29tcHV0ZWRTdHlsZSkge1xuXHQgICAgICAgICAgICBjb21wdXRlZE9iaiA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhcmdldCwgJycpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGNvbXB1dGVkT2JqID0gdGFyZ2V0LmN1cnJlbnRTdHlsZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBjb21wdXRlZE9iajtcblx0ICAgIH0sXG5cdFxuXHQgICAgLy8gZXhwb3J0IHRvIGJlIHVzZWQgYnkgdW5pdC10ZXN0XG5cdCAgICBfY2FsbGJhY2tQcm9wTmFtZTogY2FsbGJhY2tQcm9wTmFtZVxuXHR9O1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSB1dGlsO1xuXG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB0dWktY29tcG9uZW50LXBsYWNlaG9sZGVyLm1pbi5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcImRpc3RcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCBmN2U1MGNkZTYyMjI3YmY3ZGM3NyIsIid1c2Ugc3RyaWN0Jztcbi8qKiBAbmFtZXNwYWNlIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXIgKi9cbnR1aS51dGlsLmRlZmluZU5hbWVzcGFjZSgndHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlcicsIHJlcXVpcmUoJy4vcGxhY2Vob2xkZXIuanMnKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgR2VuZXJhdGUgdGhlIHZpcnR1YWwgcGxhY2Vob2xkZXIgb24gYnJvd3NlcnMgaXNuJ3Qgc3VwcG9ydGVkIHBsYWNlaG9sZGVyIGZlYXR1cmVcbiAqIEBhdXRob3IgTkhOIEVudC4gRkUgZGV2IHRlYW0uPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4vdXRpbC5qcycpO1xuXG52YXIgUGxhY2Vob2xkZXIsIHNoYXJlZEluc3RhbmNlO1xudmFyIGJyb3dzZXIgPSB0dWkudXRpbC5icm93c2VyO1xudmFyIGlzU3VwcG9ydFBsYWNlaG9sZGVyID0gJ3BsYWNlaG9sZGVyJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3BsYWNlaG9sZGVyJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xudmFyIGlzSUUgPSAhKGJyb3dzZXIubXNpZSAmJiBicm93c2VyLnZlcnNpb24gPD0gMTEpO1xudmFyIGlzU3VwcG9ydFByb3BlcnR5Y2hhbmdlID0gKGJyb3dzZXIubXNpZSAmJiBicm93c2VyLnZlcnNpb24gPCAxMSk7XG5cbnZhciBLRVlDT0RFX0JBQ0sgPSA4O1xudmFyIEtFWUNPREVfVEFCID0gOTtcbnZhciBUQVJHRVRfVEFHUyA9IFtcbiAgICAnaW5wdXQnLFxuICAgICd0ZXh0YXJlYSdcbl07XG52YXIgSU5QVVRfVFlQRVMgPSBbXG4gICAgJ3RleHQnLFxuICAgICdwYXNzd29yZCcsXG4gICAgJ2VtYWlsJyxcbiAgICAndGVsJyxcbiAgICAnbnVtYmVyJyxcbiAgICAndXJsJyxcbiAgICAnc2VhcmNoJ1xuXTtcbnZhciBXUkFQUEVSX1NUWUxFID0gdXRpbC5tYWtlU3R5bGVUZXh0KHtcbiAgICAncG9zaXRpb24nOiAncmVsYXRpdmUnLFxuICAgICdkaXNwbGF5JzogJ2lubGluZS1ibG9jaycsXG4gICAgJ292ZXJmbG93JzogJ2hpZGRlbidcbn0pO1xudmFyIERFRkFVTFRfU1RZTEUgPSB1dGlsLm1ha2VTdHlsZVRleHQoe1xuICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsXG4gICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXG4gICAgJ2NvbG9yJzogJyM5OTknLFxuICAgICd6LWluZGV4JzogJzAnXG59KTtcbnZhciBURU1QTEFURSA9ICc8c3BhbiBzdHlsZT1cInt7c3R5bGV9fVwiIFVOU0VMRUNUQUJMRT1cIm9uXCI+e3twbGFjZWhvbGRlclRleHR9fTwvc3Bhbj4nO1xuXG4vKipcbiAqIFBsYWNlaG9sZGVyIE9iamVjdFxuICogQGNvbnN0cnVjdG9yXG4gKiBAaWdub3JlXG4gKi9cblBsYWNlaG9sZGVyID0gdHVpLnV0aWwuZGVmaW5lQ2xhc3MoLyoqIEBsZW5kcyBQbGFjZWhvbGRlci5wcm90b3R5cGUgKi97XG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBcnJheSBwdXNoZWQgJ2lucHV0JyBhbmQgJ3RleHRhcmVhJyBlbGVtZW50cyBvbiBwYWdlXG4gICAgICAgICAqIEB0eXBlIHtBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGFyZ2V0cyA9IFtdO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBwbGFjZWhvbGRlcnNcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIG9wdGlvbnNcbiAgICAgKiAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy53cmFwcGVyQ2xhc3NOYW1lXSAtIHdyYXBwZXIgY2xhc3MgbmFtZVxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBnZW5lcmF0ZU9uVGFyZ2V0czogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0cyA9IHRoaXMudGFyZ2V0cy5jb25jYXQoc2VsZWN0ZWRUYXJnZXRzKTtcblxuICAgICAgICB0dWkudXRpbC5mb3JFYWNoKHRoaXMudGFyZ2V0cywgZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSB0aGlzLl9nZXRQbGFjZWhvbGRlckh0bWwodGFyZ2V0KTtcblxuICAgICAgICAgICAgdGhpcy5fYXR0YWNoUGxhY2Vob2xkZXIodGFyZ2V0LCBwbGFjZWhvbGRlciwgb3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLl9iaW5kRXZlbnQodGFyZ2V0LCB0YXJnZXQucHJldmlvdXNTaWJsaW5nKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBwbGFjZWhvbGRlcnNcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIHJlbW92ZTogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzKSB7XG4gICAgICAgIHZhciByZW1vdmVUYXJnZXRzO1xuXG4gICAgICAgIGlmIChzZWxlY3RlZFRhcmdldHMpIHtcbiAgICAgICAgICAgIHJlbW92ZVRhcmdldHMgPSB0dWkudXRpbC5maWx0ZXIoc2VsZWN0ZWRUYXJnZXRzLCBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHVpLnV0aWwuaW5BcnJheSh0YXJnZXQsIHRoaXMudGFyZ2V0cykgPj0gMDtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXRzID0gdXRpbC5yZW1vdmVBcnJheUl0ZW1zKHRoaXMudGFyZ2V0cywgcmVtb3ZlVGFyZ2V0cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZW1vdmVUYXJnZXRzID0gdGhpcy50YXJnZXRzO1xuICAgICAgICAgICAgdGhpcy50YXJnZXRzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICB0dWkudXRpbC5mb3JFYWNoKHJlbW92ZVRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy5fdW5iaW5kRXZlbnQodGFyZ2V0LCB0YXJnZXQucHJldmlvdXNTaWJsaW5nKTtcbiAgICAgICAgICAgIHRoaXMuX2RldGFjaFBsYWNlaG9sZGVyKHRhcmdldCk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIaWRlIHBsYWNlaG9sZGVycyBvbiAnaW5wdXQnIG9yICd0ZXh0YXJlYScgZWxlbWVudCB0aGF0IGFscmVhZHkgaGFzIHZhbHVlXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHN9IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIHRvIGhpZGUgcGxhY2Vob2xkZXJcbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgaGlkZU9uVGFyZ2V0czogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzKSB7XG4gICAgICAgIHR1aS51dGlsLmZvckVhY2goc2VsZWN0ZWRUYXJnZXRzLCBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgICAgIHRhcmdldC5wcmV2aW91c1NpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGFjaCBhIG5ldyB2aXJ0dWFsIHBsYWNlaG9sZGVyIGFmdGVyIGEgc2VsZWN0ZWQgJ2lucHV0JyBlbGVtZW50IGFuZCB3cmFwIHRoaXMgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCAtIFRoZSAnaW5wdXQnIG9yICd0ZXh0YXJlYScgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwbGFjZWhvbGRlciAtIEhUTUwgc3RyaW5nIG9mIHRoZSB2aXJ0dWFsIHBsYWNlaG9sZGVyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIG9wdGlvbnNcbiAgICAgKiAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy53cmFwcGVyQ2xhc3NOYW1lXSAtIHdyYXBwZXIgY2xhc3MgbmFtZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2F0dGFjaFBsYWNlaG9sZGVyOiBmdW5jdGlvbih0YXJnZXQsIHBsYWNlaG9sZGVyLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IHRhcmdldC5wYXJlbnROb2RlO1xuXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMud3JhcHBlckNsYXNzTmFtZSkge1xuICAgICAgICAgICAgd3JhcHBlci5jbGFzc05hbWUgPSBvcHRpb25zLndyYXBwZXJDbGFzc05hbWU7XG4gICAgICAgIH1cbiAgICAgICAgd3JhcHBlci5pbm5lckhUTUwgPSBwbGFjZWhvbGRlcjtcbiAgICAgICAgd3JhcHBlci5zdHlsZS5jc3NUZXh0ID0gV1JBUFBFUl9TVFlMRTtcblxuICAgICAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLCB0YXJnZXQpO1xuXG4gICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQodGFyZ2V0KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRGV0YWNoIGdlbmVyYXRlZCBwbGFjZWhvbGRlciBhbmQgcmVzdG9yZSB0aGUgdGFyZ2V0IHRvIG9yaWdpbmFsIHN0YXRlLlxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCAtIFRoZSAnaW5wdXQnIG9yICd0ZXh0YXJlYScgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2RldGFjaFBsYWNlaG9sZGVyOiBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSB3cmFwcGVyLnBhcmVudE5vZGU7XG4gICAgICAgIHZhciBwbGFjZWhvbGRlciA9IHRhcmdldC5wcmV2aW91c1NpYmxpbmc7XG5cbiAgICAgICAgd3JhcHBlci5yZW1vdmVDaGlsZChwbGFjZWhvbGRlcik7XG4gICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRhcmdldCwgd3JhcHBlcik7XG4gICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod3JhcHBlcik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEJpbmQgZXZlbnRzIG9uIHRoZSBlbGVtZW50XG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gVGhlICdpbnB1dCcgb3IgJ3RleHRhcmVhJyBlbGVtZW50XG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gcGxhY2Vob2xkZXIgLSBUaGUgdmlydHVhbCBwbGFjZWhvbGRlciBlbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYmluZEV2ZW50OiBmdW5jdGlvbih0YXJnZXQsIHBsYWNlaG9sZGVyKSB7XG4gICAgICAgIHZhciBwbGFjZWhvbGRlclN0eWxlID0gcGxhY2Vob2xkZXIuc3R5bGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uS2V5dXAoKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0LnZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyU3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgICAgICAgaWYgKHRhcmdldC52YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyU3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHV0aWwuYmluZEV2ZW50KHBsYWNlaG9sZGVyLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRhcmdldC5mb2N1cygpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaXNTdXBwb3J0UHJvcGVydHljaGFuZ2UpIHtcbiAgICAgICAgICAgIHV0aWwuYmluZEV2ZW50KHRhcmdldCwgJ3Byb3BlcnR5Y2hhbmdlJywgb25DaGFuZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAnY2hhbmdlJywgb25DaGFuZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgdXRpbC5iaW5kRXZlbnQodGFyZ2V0LCAna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZS53aGljaCB8fCBlLmtleUNvZGU7XG5cbiAgICAgICAgICAgIGlmICghKGtleUNvZGUgPT09IEtFWUNPREVfQkFDSyB8fCBrZXlDb2RlID09PSBLRVlDT0RFX1RBQiB8fFxuICAgICAgICAgICAgICAgIChlLnNoaWZ0S2V5ICYmIGtleUNvZGUgPT09IEtFWUNPREVfVEFCKSkpIHtcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlclN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHV0aWwuYmluZEV2ZW50KHRhcmdldCwgJ2tleXVwJywgb25LZXl1cCk7XG4gICAgICAgIHV0aWwuYmluZEV2ZW50KHRhcmdldCwgJ2JsdXInLCBvbktleXVwKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVW5iaW5kIGV2ZW50cyBmcm9tIHRoZSBlbGVtZW50XG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gVGhlICdpbnB1dCcgb3IgJ3RleHRhcmVhJyBlbGVtZW50XG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gcGxhY2Vob2xkZXIgLSBUaGUgdmlydHVhbCBwbGFjZWhvbGRlciBlbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdW5iaW5kRXZlbnQ6IGZ1bmN0aW9uKHRhcmdldCwgcGxhY2Vob2xkZXIpIHtcbiAgICAgICAgdXRpbC51bmJpbmRFdmVudCh0YXJnZXQsICdrZXlkb3duJyk7XG4gICAgICAgIHV0aWwudW5iaW5kRXZlbnQodGFyZ2V0LCAna2V5dXAnKTtcbiAgICAgICAgdXRpbC51bmJpbmRFdmVudCh0YXJnZXQsICdibHVyJyk7XG4gICAgICAgIHV0aWwudW5iaW5kRXZlbnQocGxhY2Vob2xkZXIsICdjbGljaycpO1xuXG4gICAgICAgIGlmIChpc1N1cHBvcnRQcm9wZXJ0eWNoYW5nZSkge1xuICAgICAgICAgICAgdXRpbC51bmJpbmRFdmVudCh0YXJnZXQsICdwcm9wZXJ0eWNoYW5nZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdXRpbC51bmJpbmRFdmVudCh0YXJnZXQsICdjaGFuZ2UnKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZpcnR1YWwgcGxhY2Vob2xkZXIncyBodG1sXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IC0gVGhlICdpbnB1dCcgb3IgJ3RleHRhcmVhJyBlbGVtZW50XG4gICAgICogQHJldHVybnMge3N0cmluZ30gU3RyaW5nIG9mIHZpcnR1YWwgcGxhY2Vob2xkZXIgdGFnXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby11c2VsZXNzLWVzY2FwZSAqL1xuICAgIF9nZXRQbGFjZWhvbGRlckh0bWw6IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgICB2YXIgaW5pdFN0eWxlID0gdXRpbC5nZXRTdHlsZSh0YXJnZXQpO1xuICAgICAgICB2YXIgcGxhY2Vob2xkZXJUZXh0ID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInKTtcbiAgICAgICAgdmFyIGhhc1ZhbHVlID0gdGFyZ2V0LnZhbHVlICE9PSAnJztcbiAgICAgICAgdmFyIGlzSW5wdXQgPSB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JztcbiAgICAgICAgdmFyIHN0eWxlT2JqID0ge1xuICAgICAgICAgICAgJ2Rpc3BsYXknOiBoYXNWYWx1ZSA/ICdub25lJyA6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgICAgICAgJ3RvcCc6IHBhcnNlSW50KGluaXRTdHlsZS5wYWRkaW5nVG9wLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChpbml0U3R5bGUuYm9yZGVyVG9wV2lkdGgsIDEwKSArICdweCcsXG4gICAgICAgICAgICAnbGVmdCc6IHBhcnNlSW50KGluaXRTdHlsZS5wYWRkaW5nTGVmdCwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoaW5pdFN0eWxlLmJvcmRlckxlZnRXaWR0aCwgMTApICsgJ3B4JyxcbiAgICAgICAgICAgICdmb250LXNpemUnOiBpbml0U3R5bGUuZm9udFNpemUsXG4gICAgICAgICAgICAnZm9udC1mYW1pbHknOiBpbml0U3R5bGUuZm9udEZhbWlseS5yZXBsYWNlKC9cXFwiL2csICdcXCcnKVxuICAgICAgICB9O1xuICAgICAgICB2YXIgYWRkU3R5bGUgPSAhaXNJbnB1dCA/IHsnd2lkdGgnOiAnOTAlJ30gOiB7J3doaXRlLXNwYWNlJzogJ25vd3JhcCd9O1xuXG4gICAgICAgIHR1aS51dGlsLmV4dGVuZChzdHlsZU9iaiwgYWRkU3R5bGUpO1xuXG4gICAgICAgIHJldHVybiB1dGlsLmFwcGx5VGVtcGxhdGUoVEVNUExBVEUsIHtcbiAgICAgICAgICAgIHN0eWxlOiBERUZBVUxUX1NUWUxFICsgdXRpbC5tYWtlU3R5bGVUZXh0KHN0eWxlT2JqKSxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyVGV4dDogcGxhY2Vob2xkZXJUZXh0XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLXVzZWxlc3MtZXNjYXBlICovXG59KTtcblxuLyoqXG4gKiBHZXQgYWxsICdpbnB1dCcgYW5kICd0ZXh0YXJlYScgZWxlbWVudHMgb24gcGFnZVxuICogQHJldHVybnMge0FycmF5LjxIVE1MRWxlbWVudD59IEFsbCBlbGVtZW50c1xuICogQGlnbm9yZVxuICovXG5mdW5jdGlvbiBnZXRBbGxUYXJnZXRzKCkge1xuICAgIHZhciBpbnB1dHMgPSB0dWkudXRpbC50b0FycmF5KGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpKTtcbiAgICB2YXIgdGV4dGFyZWFzID0gdHVpLnV0aWwudG9BcnJheShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGV4dGFyZWEnKSk7XG5cbiAgICByZXR1cm4gaW5wdXRzLmNvbmNhdCh0ZXh0YXJlYXMpO1xufVxuXG5pZiAoYnJvd3Nlci5tc2llICYmIChicm93c2VyLnZlcnNpb24gPiA5ICYmIGJyb3dzZXIudmVyc2lvbiA8PSAxMSkpIHtcbiAgICB1dGlsLmFkZENzc1J1bGUoe1xuICAgICAgICBzZWxlY3RvcjogJzotbXMtaW5wdXQtcGxhY2Vob2xkZXInLFxuICAgICAgICBjc3M6ICdjb2xvcjojZmZmICFpbXBvcnRhbnQ7dGV4dC1pbmRlbnQ6LTk5OTlweDsnXG4gICAgfSk7XG59XG5cbnNoYXJlZEluc3RhbmNlID0gbmV3IFBsYWNlaG9sZGVyKCk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHZpcnR1YWwgcGxhY2Vob2xkZXJzLlxuICAgICAqIEBwYXJhbSB7SFRNTENvbGxlY3Rpb258SFRNTEVsZW1lbnRbXX0gc2VsZWN0ZWRUYXJnZXRzIC0gU2VsZWN0ZWQgZWxlbWVudHMgZm9yIGdlbmVyYXRpbmcgcGxhY2Vob2xkZXJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gb3B0aW9uc1xuICAgICAqICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLndyYXBwZXJDbGFzc05hbWVdIC0gd3JhcHBlciBjbGFzcyBuYW1lXG4gICAgICogQG1lbWJlcm9mIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAYXBpXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB0dWkuY29tcG9uZW50LnBsYWNlaG9sZGVyLmdlbmVyYXRlKCk7XG4gICAgICogdHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlci5nZW5lcmF0ZShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSk7XG4gICAgICogdHVpLmNvbXBvbmVudC5wbGFjZWhvbGRlci5nZW5lcmF0ZShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSwge1xuICAgICAqICAgICB3cmFwcGVyQ2xhc3NOYW1lOiAnbXktY2xhc3MtbmFtZSdcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24oc2VsZWN0ZWRUYXJnZXRzLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciB0YXJnZXRzO1xuXG4gICAgICAgIGlmIChpc1N1cHBvcnRQbGFjZWhvbGRlciAmJiBpc0lFKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0YXJnZXRzID0gKHNlbGVjdGVkVGFyZ2V0cykgPyB0dWkudXRpbC50b0FycmF5KHNlbGVjdGVkVGFyZ2V0cykgOiBnZXRBbGxUYXJnZXRzKCk7XG5cbiAgICAgICAgc2hhcmVkSW5zdGFuY2UuZ2VuZXJhdGVPblRhcmdldHModHVpLnV0aWwuZmlsdGVyKHRhcmdldHMsIGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIHRhZ05hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBpbnB1dFR5cGUgPSB0YXJnZXQudHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIGRpc2FibGVTdGF0ZSA9IHRhcmdldC5kaXNhYmxlZCB8fCB0YXJnZXQucmVhZE9ubHk7XG4gICAgICAgICAgICB2YXIgaGFzUHJvcCA9ICF0dWkudXRpbC5pc051bGwodGFyZ2V0LmdldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInKSk7XG4gICAgICAgICAgICB2YXIgZW5hYmxlRWxlbSA9IHR1aS51dGlsLmluQXJyYXkodGFnTmFtZSwgVEFSR0VUX1RBR1MpID4gLTE7XG5cbiAgICAgICAgICAgIGlmICh0YWdOYW1lID09PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICAgICAgZW5hYmxlRWxlbSA9IHR1aS51dGlsLmluQXJyYXkoaW5wdXRUeXBlLCBJTlBVVF9UWVBFUykgPiAtMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGhhc1Byb3AgJiYgZW5hYmxlRWxlbSAmJiAhZGlzYWJsZVN0YXRlO1xuICAgICAgICB9KSwgb3B0aW9ucyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENsZWFyIGdlbmVyYXRlZCBwbGFjZWhvbGRlcnMuXG4gICAgICogQG1lbWJlcm9mIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0hUTUxDb2xsZWN0aW9ufEhUTUxFbGVtZW50W119IHNlbGVjdGVkVGFyZ2V0cyAtIFNlbGVjdGVkIGVsZW1lbnRzIGZvciBnZW5lcmF0aW5nIHBsYWNlaG9sZGVyXG4gICAgICovXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihzZWxlY3RlZFRhcmdldHMpIHtcbiAgICAgICAgdmFyIHRhcmdldHM7XG5cbiAgICAgICAgaWYgKGlzU3VwcG9ydFBsYWNlaG9sZGVyICYmIGlzSUUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhcmdldHMgPSAoc2VsZWN0ZWRUYXJnZXRzKSA/IHR1aS51dGlsLnRvQXJyYXkoc2VsZWN0ZWRUYXJnZXRzKSA6IG51bGw7XG4gICAgICAgIHNoYXJlZEluc3RhbmNlLnJlbW92ZSh0YXJnZXRzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogV2hlbiAnaW5wdXQnIG9yICd0ZXh0YXJlYScgZWxlbWVudCBhbHJlYWR5IGhhcyB2YWx1ZSwgaGlkaW5nIHRoZSB2aXJ0dWFsIHBsYWNlaG9sZGVyXG4gICAgICogQG1lbWJlcm9mIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHR1aS5jb21wb25lbnQucGxhY2Vob2xkZXIuaGlkZU9uSW5wdXRIYXZpbmdWYWx1ZSgpO1xuICAgICAqL1xuICAgIGhpZGVPbklucHV0SGF2aW5nVmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoaXNTdXBwb3J0UGxhY2Vob2xkZXIgJiYgaXNJRSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2hhcmVkSW5zdGFuY2UuaGlkZU9uVGFyZ2V0cyh0dWkudXRpbC5maWx0ZXIoc2hhcmVkSW5zdGFuY2UudGFyZ2V0cywgZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gKHRhcmdldC52YWx1ZSAhPT0gJycgJiYgdGFyZ2V0LnR5cGUgIT09IElOUFVUX1RZUEVTWzFdKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9wbGFjZWhvbGRlci5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbnZhciBjYWxsYmFja1Byb3BOYW1lID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgcmV0dXJuICdfX2NiX3R1aV9wbGFjZWhvbGRlcl8nICsgZXZlbnRUeXBlICsgJ19fJztcbn07XG5cbnZhciBoYXNDb21wdXRlZFN0eWxlID0gKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKTtcblxudmFyIHV0aWwgPSB7XG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgJ3N0eWxlJyBlbGVtZW50IGFuZCBhZGQgY3NzIHJ1bGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcnVsZUluZm8gLSBWYWx1ZSBvZiBzZWxlY3RvciBhbmQgY3NzIHByb3BlcnR5XG4gICAgICovXG4gICAgYWRkQ3NzUnVsZTogZnVuY3Rpb24ocnVsZUluZm8pIHtcbiAgICAgICAgdmFyIHN0eWxlVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gcnVsZUluZm8uc2VsZWN0b3I7XG4gICAgICAgIHZhciBjc3MgPSBydWxlSW5mby5jc3M7XG4gICAgICAgIHZhciBzdHlsZVNoZWV0O1xuXG4gICAgICAgIGlmIChkb2N1bWVudC5oZWFkKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlVGFnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoc3R5bGVUYWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3R5bGVTaGVldCA9IHN0eWxlVGFnLnNoZWV0IHx8IHN0eWxlVGFnLnN0eWxlU2hlZXQ7XG5cbiAgICAgICAgaWYgKHN0eWxlU2hlZXQuaW5zZXJ0UnVsZSkge1xuICAgICAgICAgICAgc3R5bGVTaGVldC5pbnNlcnRSdWxlKHNlbGVjdG9yICsgJ3snICsgY3NzICsgJ30nLCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0eWxlU2hlZXQuYWRkUnVsZShzZWxlY3RvciwgY3NzLCAwKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBCaW5kIGV2ZW50IHRvIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBET00gZWxlbWVudCB0byBhdHRhY2ggdGhlIGV2ZW50IGhhbmRsZXIgb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlIC0gRXZlbnQgdHlwZVxuICAgICAqIEBwYXJhbSB7cmVxdWVzdENhbGxiYWNrfSBjYWxsYmFjayAtIEV2ZW50IGhhbmRsZXIgZnVuY3Rpb25cbiAgICAgKi9cbiAgICBiaW5kRXZlbnQ6IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnRUeXBlLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHRydWU7XG5cbiAgICAgICAgaWYgKHRhcmdldC5hZGRFdmVudExpc3RlbmVyICYmIGV2ZW50VHlwZSAhPT0gJ3Byb3BlcnR5Y2hhbmdlJykge1xuICAgICAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYWxsYmFjaywgZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKHRhcmdldC5hdHRhY2hFdmVudCkge1xuICAgICAgICAgICAgdGFyZ2V0LmF0dGFjaEV2ZW50KCdvbicgKyBldmVudFR5cGUsIGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgICB0YXJnZXRbY2FsbGJhY2tQcm9wTmFtZShldmVudFR5cGUpXSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFVuYmluZCBldmVudCBmcm9tIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBET00gZWxlbWVudCB0byBkZXRhY2ggdGhlIGV2ZW50IGhhbmRsZXIgZnJvbVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGUgLSBFdmVudCB0eXBlXG4gICAgICovXG4gICAgdW5iaW5kRXZlbnQ6IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnRUeXBlKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRhcmdldFtjYWxsYmFja1Byb3BOYW1lKGV2ZW50VHlwZSldO1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHRydWU7XG5cbiAgICAgICAgaWYgKHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyICYmIGV2ZW50VHlwZSAhPT0gJ3Byb3BlcnR5Y2hhbmdlJykge1xuICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYWxsYmFjayk7XG4gICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0LmRldGFjaEV2ZW50KSB7XG4gICAgICAgICAgICB0YXJnZXQuZGV0YWNoRXZlbnQoJ29uJyArIGV2ZW50VHlwZSwgY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRbY2FsbGJhY2tQcm9wTmFtZShldmVudFR5cGUpXTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGFyZ2V0IGl0ZW1zIGZyb20gc291cmNlIGFycmF5IGFuZCByZXR1cm5zIGEgbmV3IHJlbW92ZWQgYXJyYXkuXG4gICAgICogQHBhcmFtIHthcnJheX0gc291cmNlSXRlbXMgLSBzb3VyY2UgYXJyYXlcbiAgICAgKiBAcGFyYW0ge2FycmF5fSB0YXJnZXRJdGVtcyAtIHRhcmdldCBpdGVtc1xuICAgICAqIEByZXR1cm5zIHthcnJheX0gbmV3IHJlbW92ZWQgYXJyYXlcbiAgICAgKi9cbiAgICByZW1vdmVBcnJheUl0ZW1zOiBmdW5jdGlvbihzb3VyY2VJdGVtcywgdGFyZ2V0SXRlbXMpIHtcbiAgICAgICAgcmV0dXJuIHR1aS51dGlsLmZpbHRlcihzb3VyY2VJdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIHR1aS51dGlsLmluQXJyYXkoaXRlbSwgdGFyZ2V0SXRlbXMpID09PSAtMTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE1ha2UgQ1NTVGV4dFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdHlsZU9iaiAtIFN0eWxlIGluZm8gb2JqZWN0XG4gICAgICogQHJldHVybnMge3N0cmluZ30gQ29ubmVjdGVkIHN0cmluZyBvZiBzdHlsZVxuICAgICAqL1xuICAgIG1ha2VTdHlsZVRleHQ6IGZ1bmN0aW9uKHN0eWxlT2JqKSB7XG4gICAgICAgIHZhciBzdHlsZVN0ciA9ICcnO1xuXG4gICAgICAgIHR1aS51dGlsLmZvckVhY2goc3R5bGVPYmosIGZ1bmN0aW9uKHZhbHVlLCBwcm9wKSB7XG4gICAgICAgICAgICBzdHlsZVN0ciArPSBwcm9wICsgJzonICsgdmFsdWUgKyAnOyc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBzdHlsZVN0cjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSBtYXRjaGVkIHByb3BlcnR5IHdpdGggdGVtcGxhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGVtcGxhdGUgLSBTdHJpbmcgb2YgdGVtcGxhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcE9iaiAtIFByb3BlcnRpZXNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXBsYWNlZCB0ZW1wbGF0ZSBzdHJpbmdcbiAgICAgKi9cbiAgICBhcHBseVRlbXBsYXRlOiBmdW5jdGlvbih0ZW1wbGF0ZSwgcHJvcE9iaikge1xuICAgICAgICB2YXIgbmV3VGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHsoXFx3KilcXH1cXH0vZywgZnVuY3Rpb24odmFsdWUsIHByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wT2JqLmhhc093blByb3BlcnR5KHByb3ApID8gcHJvcE9ialtwcm9wXSA6ICcnO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gbmV3VGVtcGxhdGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgZWxlbWVudCdzIHN0eWxlIHZhbHVlIGRlZmluZWQgYXQgY3NzIGZpbGVcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBDdXJyZW50IGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBTdHlsZSBvYmplY3Qgb2YgZWxlbWVudFxuICAgICAqL1xuICAgIGdldFN0eWxlOiBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgdmFyIGNvbXB1dGVkT2JqO1xuXG4gICAgICAgIGlmIChoYXNDb21wdXRlZFN0eWxlKSB7XG4gICAgICAgICAgICBjb21wdXRlZE9iaiA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhcmdldCwgJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29tcHV0ZWRPYmogPSB0YXJnZXQuY3VycmVudFN0eWxlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbXB1dGVkT2JqO1xuICAgIH0sXG5cbiAgICAvLyBleHBvcnQgdG8gYmUgdXNlZCBieSB1bml0LXRlc3RcbiAgICBfY2FsbGJhY2tQcm9wTmFtZTogY2FsbGJhY2tQcm9wTmFtZVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlsO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvdXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9